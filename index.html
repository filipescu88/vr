<html>
  <head>
    <title>Joystick Oculus</title>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene vr-mode-ui="enabled: true" background="color: #ECECEC">
      
      <!-- Kamera + rig (ruch i kontrolery) -->
      <a-entity id="rig" position="0 1.6 0" 
                gamepad-controls="enabled: true; movementEnabled: true; sensitivity: 0.1; speed: 0.1">
        <a-camera id="camera"></a-camera>
        
        <!-- Lewy kontroler Oculus Touch -->
        <a-entity
          id="leftController"
          hand-controls="hand: left; handModelStyle: lowPoly; color: #FF0000"
          raycaster="objects: .clickable"
          line="color: green; opacity: 0.75"
          >
        </a-entity>
        
        <!-- Prawy kontroler Oculus Touch -->
        <a-entity
          id="rightController"
          hand-controls="hand: right; handModelStyle: lowPoly; color: #0000FF"
          raycaster="objects: .clickable"
          line="color: blue; opacity: 0.75"
          >
        </a-entity>
      </a-entity>
      
      <!-- Klikalny box -->
      <a-box 
        class="clickable" 
        position="0 1.5 -3" 
        color="red" 
        depth="0.5" 
        height="0.5" 
        width="0.5">
      </a-box>
      
      <!-- Światła -->
      <a-light type="ambient" color="#888"></a-light>
      <a-light type="directional" intensity="0.5" position="1 1 0.5"></a-light>

      <!-- Podłoga -->
      <a-plane rotation="-90 0 0" width="10" height="10" color="#7BC8A4"></a-plane>
      
      <script>
        // Obsługa triggerdown na kontrolerach
        function setupControllerClicks(controllerId) {
          const controller = document.getElementById(controllerId);
          controller.addEventListener('triggerdown', () => {
            const intersects = controller.components.raycaster.intersectedEls;
            if (intersects.length > 0) {
              intersects.forEach(el => {
                if (el.classList.contains('clickable')) {
                  // Zmień kolor na losowy
                  el.setAttribute('color', '#' + Math.floor(Math.random()*16777215).toString(16));
                  console.log(`Box clicked by ${controllerId}`);
                }
              });
            }
          });
        }
        
        setupControllerClicks('leftController');
        setupControllerClicks('rightController');
      </script>
      
    </a-scene>
  </body>
</html>
